!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Appoint=e()}(this,function(){"use strict";function t(t,e){var n=e.length;if(0===n||"function"!=typeof e[0])throw Error("not function");var o=e[0],i=n>1?e[1]:null,r=Array.prototype.slice.call(e,2);return function(){var e=o.apply(t,r);"function"==typeof i&&i(e)}}function e(){}function n(t){return"function"==typeof t}function o(t){return"object"==typeof t}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t){var e=t&&t.then;if(t&&(o(t)||n(t))&&n(e))return n(e.bind)?e.bind(t):function(n,o){return e.call(t,n,o)}}function u(t,e,n){E(function(){var o;try{o=e(n)}catch(e){return f(t,e)}o===t?f(t,new TypeError("Cannot resolve promise with itself")):c(t,o)})}function c(t,e){try{var n=r(e);return n?s(t,n):(t.setState(a.FULFILLED),t.value=e,t.queue.forEach(function(t){t.callFulfilled(e)})),t}catch(e){return f(t,e)}}function s(t,e){var n=!1;try{e(function(e){n||(n=!0,c(t,e))},function(e){n||(n=!0,f(t,e))})}catch(e){if(n)return;n=!0,f(t,e)}}function f(t,e){return t.setState(a.REJECTED),t.value=e,t.handled&&E(function(){t.handled&&("undefined"!=typeof process?process.emit("unhandledRejection",e,t):console.error(e))}),t.queue.forEach(function(t){t.callRejected(e)}),t}var a;!function(t){t[t.PENDING=0]="PENDING",t[t.FULFILLED=1]="FULFILLED",t[t.REJECTED=2]="REJECTED"}(a||(a={}));var l,h="undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process).toLowerCase(),d={isNode:h,isRecentNode:h&&function(){var t=process.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),getNativePromise:function(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(t){return}}},p=d.getNativePromise();if(d.isNode&&"undefined"==typeof MutationObserver){var v=global.setImmediate,y=process.nextTick;l=d.isRecentNode?function(){v(t(this,arguments))}:function(){y(t(this,arguments))}}else if("function"==typeof p&&"function"==typeof p.resolve){var m=p.resolve();l=function(){m.then(t(this,arguments))}}else l="undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&(window.navigator.standalone||window.cordova)?"undefined"!=typeof setImmediate?function(){setImmediate(t(this,arguments))}:"undefined"!=typeof setTimeout?function(){setTimeout(t(this,arguments),0)}:function(){throw new Error("NO_ASYNC_SCHEDULER")}:function(){var e=document.createElement("div"),n={attributes:!0},o=!1,i=document.createElement("div");new MutationObserver(function(){e.classList.toggle("foo"),o=!1}).observe(i,n);var r=function(){o||(o=!0,i.classList.toggle("foo"))};return function(){var o=t(this,arguments),i=new MutationObserver(function(){i.disconnect(),o()});i.observe(e,n),r()}}();var E=l,w=function(){return function(t,e,o){this.promise=t,n(e)?this.callFulfilled=function(t){u(this.promise,e,t)}:this.callFulfilled=function(t){c(this.promise,t)},n(o)?this.callRejected=function(t){u(this.promise,o,t)}:this.callRejected=function(t){f(this.promise,t)}}}();return function(){function t(t){if(!n(t))throw new TypeError("resolver must be a function");this.state=a.PENDING,this.value=void 0,this.queue=[],this.handled=!0,t!==e&&s(this,t)}return t.resolve=function(n){return n instanceof t?n:c(new t(e),n)},t.reject=function(n){return n instanceof t?n:f(new t(e),n)},t.all=function(n){var o=this;if(!i(n))return this.reject(new TypeError("must be an array"));var r=n.length,u=!1;if(!r)return this.resolve([]);for(var s=new Array(r),a=-1,l=new t(e);++a<r;)!function(t,e){o.resolve(t).then(function(t){s[e]=t,e!==r-1||u||(u=!0,c(l,s))},function(t){u||(u=!0,f(l,t))})}(n[a],a);return l},t.race=function(t){var n=this;if(!i(t))return this.reject(new TypeError("must be an array"));var o=t.length,r=!1;if(!o)return this.resolve([]);new Array(o);for(var u=-1,s=new n(e);++u<o;)!function(t){n.resolve(t).then(function(t){r||(r=!0,c(s,t))},function(t){r||(r=!0,f(s,t))})}(t[u]);return s},t.polyfill=function(){!function(e){"function"!=typeof e.Promise&&(e.Promise=t)}("undefined"==typeof global?window:global)},t.prototype.then=function(o,i){if(!n(o)&&this.state===a.FULFILLED||!n(i)&&this.state===a.REJECTED)return this;var r=new t(e);return this.handled&&(this.handled=null),this.getState()!==a.PENDING?u(r,this.getState()===a.FULFILLED?o:i,this.value):this.queue.push(new w(r,o,i)),r},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.setState=function(t){this.state===a.PENDING&&this.state!==t&&(this.state=t)},t.prototype.getState=function(){return this.state},t}()});
