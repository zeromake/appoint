!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Appoint=n()}(this,function(){"use strict";function t(){return void 0!==d?function(){d(e)}:n()}function n(){var t=setTimeout;return function(){return t(e,1)}}function e(){for(var t=0;t<v;t+=2)(0,F[t])(F[t+1]),F[t]=void 0,F[t+1]=void 0;v=0}function r(){}function o(t){return"function"==typeof t}function i(t){return"object"==typeof t}function u(t){return"[object Array]"===Object.prototype.toString.call(t)}function c(t){var n=t&&t.then;if(t&&(i(t)||o(t))&&o(n))return o(n.bind)?n.bind(t):function(e,r){return n.call(t,e,r)}}function f(t,n,e){w(function(){var r;try{r=n(e)}catch(n){return l(t,n)}r===t?l(t,new TypeError("Cannot resolve promise with itself")):a(t,r)})}function a(t,n){try{var e=c(n);return e?s(t,e):(t.setState(p.FULFILLED),t.value=n,t.queue.forEach(function(t){t.callFulfilled(n)})),t}catch(n){return l(t,n)}}function s(t,n){var e=!1;try{n(function(n){e||(e=!0,a(t,n))},function(n){e||(e=!0,l(t,n))})}catch(n){if(e)return;e=!0,l(t,n)}}function l(t,n){return t.setState(p.REJECTED),t.value=n,t.handled&&w(function(){t.handled&&("undefined"!=typeof process?process.emit("unhandledRejection",n,t):console.error(n))}),t.queue.forEach(function(t){t.callRejected(n)}),t}function h(t){return function(t){function n(t,n){return n?i(n)?n:c(n)||u(n)?s.call(t,n):"function"==typeof n?e(t,n):Array.isArray(n)?r(t,n):f(n)?o(t,n):n:n}function e(n,e){return new t(function(t,r){e.call(n,function(n,e){if(n)return r(n);arguments.length>2&&(e=a.call(arguments,1)),t(e)})})}function r(e,r){return t.all(r.map(function(t){return n(e,t)}))}function o(e,r){for(var o={},u=Object.keys(r),c=[],f=0,a=u.length;f<a;f++)!function(t,f){var a=u[t],s=r[a],l=n(e,s);l&&i(l)?c.push(l.then(function(t){o[a]=t})):o[a]=s}(f);return t.all(c).then(function(){return o})}function i(t){return"function"==typeof t.then}function u(t){return"function"==typeof t.next&&"function"==typeof t.throw}function c(t){var n=t.constructor;return!!n&&("GeneratorFunction"===n.name||"GeneratorFunction"===n.displayName||u(n.prototype))}function f(t){return Object===t.constructor}var a=Array.prototype.slice,s=function(e){var r=this,o=a.call(arguments,1);return new t(function(t,u){function c(t){var n;try{n=e.next(t)}catch(t){return u(t)}return a(n),null}function f(t){var n;try{n=e.throw(t)}catch(t){return u(t)}a(n)}function a(e){if(e.done)return t(e.value);var o=n(r,e.value);return o&&i(o)?o.then(c,f):f(new TypeError('You may only yield a function, promise, generator, array, or object, but the following object was passed: "'+String(e.value)+'"'))}if("function"==typeof e&&(e=e.apply(r,o)),!e||"function"!=typeof e.next)return t(e);c()})};return s.wrap=function(t){var n=function(){return s.call(this,t.apply(this,arguments))};return n.__generatorFunction__=t,n},s}(t)}var p;!function(t){t[t.PENDING=0]="PENDING",t[t.FULFILLED=1]="FULFILLED",t[t.REJECTED=2]="REJECTED"}(p||(p={}));var d,y,v=0,w=function(t,n){F[v]=t,F[v+1]=n,2===(v+=2)&&y()},E="undefined"!=typeof window?window:void 0,m=E||{},b=m.MutationObserver||m.WebKitMutationObserver,g="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),j="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,F=new Array(1e3);y=g?function(){return process.nextTick(e)}:b?function(){var t=0,n=new b(e),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}():j?function(){var t=new MessageChannel;return t.port1.onmessage=e,function(){return t.port2.postMessage(0)}}():void 0===E&&"function"==typeof require?function(){try{var e=require("vertx");return d=e.runOnLoop||e.runOnContext,t()}catch(t){return n()}}():n();var L=function(){return function(t,n,e){this.promise=t,o(n)?this.callFulfilled=function(t){f(this.promise,n,t)}:this.callFulfilled=function(t){a(this.promise,t)},o(e)?this.callRejected=function(t){f(this.promise,e,t)}:this.callRejected=function(t){l(this.promise,t)}}}();return function(){function t(t){if(!o(t))throw new TypeError("resolver must be a function");this.state=p.PENDING,this.value=void 0,this.queue=[],this.handled=!0,t!==r&&s(this,t)}return t.resolve=function(n){return n instanceof t?n:a(new t(r),n)},t.reject=function(n){return n instanceof t?n:l(new t(r),n)},t.all=function(n){var e=this;if(!u(n))return this.reject(new TypeError("must be an array"));var o=n.length,i=!1;if(!o)return this.resolve([]);for(var c=new Array(o),f=-1,s=new t(r);++f<o;)!function(t,n){e.resolve(t).then(function(t){c[n]=t,n!==o-1||i||(i=!0,a(s,c))},function(t){i||(i=!0,l(s,t))})}(n[f],f);return s},t.race=function(t){var n=this;if(!u(t))return this.reject(new TypeError("must be an array"));var e=t.length,o=!1;if(!e)return this.resolve([]);new Array(e);for(var i=-1,c=new n(r);++i<e;)!function(t){n.resolve(t).then(function(t){o||(o=!0,a(c,t))},function(t){o||(o=!0,l(c,t))})}(t[i]);return c},t.polyfill=function(){!function(n){"function"!=typeof n.Promise&&(n.Promise=t)}("undefined"==typeof global?window:global)},t.prototype.then=function(n,e){if(!o(n)&&this.state===p.FULFILLED||!o(e)&&this.state===p.REJECTED)return this;var i=new t(r);return this.handled&&(this.handled=null),this.getState()!==p.PENDING?f(i,this.getState()===p.FULFILLED?n:e,this.value):this.queue.push(new L(i,n,e)),i},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.setState=function(t){this.state===p.PENDING&&this.state!==t&&(this.state=t)},t.prototype.getState=function(){return this.state},t.co=h(t),t}()});
